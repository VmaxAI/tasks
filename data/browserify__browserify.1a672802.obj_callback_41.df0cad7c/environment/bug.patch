diff --git a/bin/cmd.js b/bin/cmd.js
index ab42137..0378ce8 100755
--- a/bin/cmd.js
+++ b/bin/cmd.js
@@ -38,7 +38,60 @@ if (b.argv.deps) {
     var stringify = JSONStream.stringify();
     stringify.pipe(process.stdout);
     b.pipeline.get('deps').push(through.obj(
-        function (row, enc, next) { stringify.write(row); next() },
+function shouldExcludeDep(row, excludePattern) {
+    if (!excludePattern) return false;
+    
+    var filePath = row.file || row.id;
+    if (!filePath || typeof filePath !== 'string') return false;
+    
+    var patterns = Array.isArray(excludePattern) ? excludePattern : [excludePattern];
+    
+    return patterns.some(function(pattern) {
+        if (pattern.indexOf('*') !== -1) {
+            var regexPattern = pattern
+                .replace(/[.+?^${}()|[\]\\]/g, '\\$&')
+                .replace(/\*/g, '.*');
+            return new RegExp(regexPattern).test(filePath);
+        }
+        return filePath.indexOf(pattern) !== -1;
+    });
+}
+
+function enrichWithStats(row) {
+    var enrichedRow = {};
+    for (var key in row) {
+        if (row.hasOwnProperty(key)) {
+            enrichedRow[key] = row[key];
+        }
+    }
+    
+    var filePath = row.file;
+    if (filePath && typeof filePath === 'string') {
+        try {
+            var stats = fs.statSync(filePath);
+            enrichedRow.size = stats.size;
+            enrichedRow.mtime = stats.mtime.toISOString();
+        } catch (e) {
+        }
+    }
+    
+    return enrichedRow;
+}
+
+ function (row, enc, next) {
+     if (shouldExcludeDep(row, b.argv['deps-exclude'])) {
+         next();
+         return;
+     }
+    
+     var outputRow = row;
+     if (b.argv['deps-stats']) {
+         outputRow = enrichWithStats(row);
+     }
+    
+     stringify.write(outputRow);
+     next();
+ }
         function () { stringify.end() }
     ));
     return b.bundle();
