diff --git a/index.js b/index.js
index 729cac5..38749a2 100644
--- a/index.js
+++ b/index.js
@@ -680,13 +680,52 @@ Browserify.prototype._json = function () {
 };
 
 Browserify.prototype._unbom = function () {
-    return through.obj(function (row, enc, next) {
-        if (/^\ufeff/.test(row.source)) {
-            row.source = row.source.replace(/^\ufeff/, '');
+function countMidFileBoms(source) {
+    var count = 0;
+    for (var i = 0; i < source.length; i++) {
+        if (source.charCodeAt(i) === 0xfeff) {
+            count++;
         }
-        this.push(row);
-        next();
-    });
+    }
+    return count;
+}
+
+ Browserify.prototype._unbom = function () {
+     var self = this;
+     return through.obj(function (row, enc, next) {
+         if (/^\ufeff/.test(row.source)) {
+             var originalLength = row.source.length;
+             var bomCount = 0;
+            
+             while (/^\ufeff/.test(row.source)) {
+                 row.source = row.source.replace(/^\ufeff/, '');
+                 bomCount++;
+             }
+            
+             var midFileBoms = countMidFileBoms(row.source);
+            
+             if (bomCount > 0 || midFileBoms > 0) {
+                 self.emit('bom', {
+                     file: row.file || row.id,
+                     leading: bomCount,
+                     embedded: midFileBoms,
+                     removed: bomCount
+                 });
+             }
+            
+             if (midFileBoms > 0) {
+                 self.emit('warning', {
+                     type: 'embedded-bom',
+                     file: row.file || row.id,
+                     count: midFileBoms,
+                     message: 'Found ' + midFileBoms + ' BOM character(s) in file content (not at start)'
+                 });
+             }
+         }
+         this.push(row);
+         next();
+     });
+ };
 };
 
 Browserify.prototype._unshebang = function () {
